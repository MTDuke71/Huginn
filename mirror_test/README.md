# Mirror Evaluation Test Suite

This directory contains tools for testing evaluation function symmetry in the Huginn chess engine.

## Files

- **`mirror_eval_test.cpp`** - Main test program that evaluates all positions in mirror.epd
- **`mirror_eval_results.txt`** - Output file with detailed test results (generated by test)

## Usage

### Quick Run (from mirror_test directory)
```powershell
cd mirror_test
.\run_mirror_test.ps1
```

### Manual Build and Run
```powershell
# Build (from project root)
cmake --build build/msvc-x64-release --config Release --target mirror_eval_test --parallel 24

# Run (from project root)
.\build\msvc-x64-release\bin\Release\mirror_eval_test.exe
```

## Script Options

- **`-Clean`** - Remove previous results before running
- **`-Verbose`** - Show detailed build and test output

### Examples
```powershell
cd mirror_test
.\run_mirror_test.ps1                 # Standard run
.\run_mirror_test.ps1 -Clean          # Clean run
.\run_mirror_test.ps1 -Verbose        # Detailed output
.\run_mirror_test.ps1 -Clean -Verbose # Both options
```

## What It Tests

The mirror evaluation test validates that the evaluation function is **symmetric**:

1. **Loads all 134 positions** from `test/mirror.epd`
2. **Evaluates each position** using the current evaluation function
3. **Creates mirrored positions** (vertically flipped with swapped colors)
4. **Evaluates mirrored positions** and compares with original
5. **Reports any asymmetries** that indicate evaluation bugs

## Expected Results

✅ **All positions should PASS** (100% symmetric)
- Original eval should equal mirrored eval for every position
- Any FAIL indicates an asymmetric bug in the evaluation function

## Output Format

```
Position | Original Eval | Mirrored Eval | Difference | Status
---------|---------------|---------------|------------|--------
       1 |            20 |            20 |          0 | PASS
       2 |            15 |            15 |          0 | PASS
     ...
```

## VICE Part 80 Compliance

Current implementation includes:
- ✅ Material values (Pawn=100, Knight=320, Bishop=330, Rook=500, Queen=900, King=20000)
- ✅ Piece-square tables (symmetric for both colors)
- ✅ Isolated pawn penalties (-10cp using pre-computed masks)  
- ✅ Passed pawn bonuses (0-200cp by rank using pre-computed masks)

All features are **perfectly symmetric** and pass the mirror test.
